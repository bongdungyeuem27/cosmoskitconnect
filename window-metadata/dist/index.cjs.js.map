{"version":3,"file":"index.cjs.js","sources":["../src/index.ts"],"sourcesContent":["import { getDocumentOrThrow, getLocationOrThrow } from \"@cosmoskitconnect/window-getters\";\n\nexport interface IWebsiteMetadata {\n  description: string;\n  url: string;\n  icons: string[];\n  name: string;\n}\n\nexport function getWindowMetadata(): IWebsiteMetadata | null {\n  let doc: Document;\n  let loc: Location;\n\n  try {\n    doc = getDocumentOrThrow();\n    loc = getLocationOrThrow();\n  } catch (e) {\n    return null;\n  }\n\n  function getIcons(): string[] {\n    // eslint-disable-next-line no-undef\n    const links: HTMLCollectionOf<HTMLLinkElement> = doc.getElementsByTagName(\"link\");\n    const icons: string[] = [];\n\n    for (let i = 0; i < links.length; i++) {\n      const link: HTMLLinkElement = links[i];\n\n      const rel: string | null = link.getAttribute(\"rel\");\n      if (rel) {\n        if (rel.toLowerCase().indexOf(\"icon\") > -1) {\n          const href: string | null = link.getAttribute(\"href\");\n\n          if (href) {\n            if (\n              href.toLowerCase().indexOf(\"https:\") === -1 &&\n              href.toLowerCase().indexOf(\"http:\") === -1 &&\n              href.indexOf(\"//\") !== 0\n            ) {\n              let absoluteHref: string = loc.protocol + \"//\" + loc.host;\n\n              if (href.indexOf(\"/\") === 0) {\n                absoluteHref += href;\n              } else {\n                const path: string[] = loc.pathname.split(\"/\");\n                path.pop();\n                const finalPath: string = path.join(\"/\");\n                absoluteHref += finalPath + \"/\" + href;\n              }\n\n              icons.push(absoluteHref);\n            } else if (href.indexOf(\"//\") === 0) {\n              const absoluteUrl: string = loc.protocol + href;\n\n              icons.push(absoluteUrl);\n            } else {\n              icons.push(href);\n            }\n          }\n        }\n      }\n    }\n\n    return icons;\n  }\n\n  function getWindowMetadataOfAny(...args: string[]): string {\n    // eslint-disable-next-line no-undef\n    const metaTags: HTMLCollectionOf<HTMLMetaElement> = doc.getElementsByTagName(\"meta\");\n\n    for (let i = 0; i < metaTags.length; i++) {\n      const tag: HTMLMetaElement = metaTags[i];\n      const attributes: Array<string | null> = [\"itemprop\", \"property\", \"name\"]\n        .map((target: string) => tag.getAttribute(target))\n        .filter((attr: string | null) => {\n          if (attr) {\n            return args.includes(attr);\n          }\n          return false;\n        });\n\n      if (attributes.length && attributes) {\n        const content: string | null = tag.getAttribute(\"content\");\n        if (content) {\n          return content;\n        }\n      }\n    }\n\n    return \"\";\n  }\n\n  function getName(): string {\n    let name: string = getWindowMetadataOfAny(\"name\", \"og:site_name\", \"og:title\", \"twitter:title\");\n\n    if (!name) {\n      name = doc.title;\n    }\n\n    return name;\n  }\n\n  function getDescription(): string {\n    const description: string = getWindowMetadataOfAny(\n      \"description\",\n      \"og:description\",\n      \"twitter:description\",\n      \"keywords\",\n    );\n\n    return description;\n  }\n\n  const name: string = getName();\n  const description: string = getDescription();\n  const url: string = loc.origin;\n  const icons: string[] = getIcons();\n\n  const meta: IWebsiteMetadata = {\n    description,\n    url,\n    icons,\n    name,\n  };\n\n  return meta;\n}\n"],"names":["doc","loc","getDocumentOrThrow","getLocationOrThrow","getIcons","links","icons","link","rel","href","absoluteHref","path","finalPath","absoluteUrl","getWindowMetadataOfAny","args","metaTags","tag","attributes","target","attr","content","getName","name","getDescription","description","url"],"mappings":";;;;;;AASO,SAAS,iBAA6C,EAAA,CAC3D,IAAIA,CAAAA,CACAC,CAEJ,CAAA,GAAI,CACFD,CAAME,CAAAA,gCAAAA,EACND,CAAAA,CAAAA,CAAME,gCAAmB,GAC3B,CAAS,MAAA,CAAA,CAAP,CACA,OAAO,IACT,CAEA,SAASC,CAAAA,EAAqB,CAE5B,MAAMC,EAA2CL,CAAI,CAAA,oBAAA,CAAqB,MAAM,CAAA,CAC1EM,CAAkB,CAAA,EAExB,CAAA,IAAA,IAAS,CAAI,CAAA,CAAA,CAAG,CAAID,CAAAA,CAAAA,CAAM,MAAQ,CAAA,CAAA,EAAA,CAAK,CACrC,MAAME,EAAwBF,CAAM,CAAA,CAAC,CAE/BG,CAAAA,CAAAA,CAAqBD,CAAK,CAAA,YAAA,CAAa,KAAK,CAAA,CAClD,GAAIC,CAAAA,EACEA,CAAI,CAAA,WAAA,EAAc,CAAA,OAAA,CAAQ,MAAM,CAAA,CAAI,GAAI,CAC1C,MAAMC,CAAsBF,CAAAA,CAAAA,CAAK,YAAa,CAAA,MAAM,CAEpD,CAAA,GAAIE,CACF,CAAA,GACEA,CAAK,CAAA,WAAA,EAAc,CAAA,OAAA,CAAQ,QAAQ,CAAA,GAAM,IACzCA,CAAK,CAAA,WAAA,EAAc,CAAA,OAAA,CAAQ,OAAO,CAAA,GAAM,CACxCA,CAAAA,EAAAA,CAAAA,CAAK,OAAQ,CAAA,IAAI,CAAM,GAAA,CAAA,CACvB,CACA,IAAIC,CAAuBT,CAAAA,CAAAA,CAAI,SAAW,IAAOA,CAAAA,CAAAA,CAAI,IAErD,CAAA,GAAIQ,CAAK,CAAA,OAAA,CAAQ,GAAG,CAAA,GAAM,CACxBC,CAAAA,CAAAA,EAAgBD,CACX,CAAA,KAAA,CACL,MAAME,CAAAA,CAAiBV,CAAI,CAAA,QAAA,CAAS,MAAM,GAAG,CAAA,CAC7CU,CAAK,CAAA,GAAA,EACL,CAAA,MAAMC,CAAoBD,CAAAA,CAAAA,CAAK,KAAK,GAAG,CAAA,CACvCD,CAAgBE,EAAAA,CAAAA,CAAY,GAAMH,CAAAA,EAAAA,CAGpCH,CAAM,CAAA,IAAA,CAAKI,CAAY,EACdD,CAAAA,KAAAA,GAAAA,CAAAA,CAAK,OAAQ,CAAA,IAAI,CAAM,GAAA,CAAA,CAAG,CACnC,MAAMI,CAAsBZ,CAAAA,CAAAA,CAAI,QAAWQ,CAAAA,CAAAA,CAE3CH,CAAM,CAAA,IAAA,CAAKO,CAAW,EAAA,CAAA,KAEtBP,EAAM,IAAKG,CAAAA,CAAI,EAOzB,CAAA,CAAA,OAAOH,CACT,CAEA,SAASQ,CAAAA,CAAAA,GAA0BC,CAAwB,CAAA,CAEzD,MAAMC,CAAAA,CAA8ChB,CAAI,CAAA,oBAAA,CAAqB,MAAM,CAAA,CAEnF,QAAS,CAAI,CAAA,CAAA,CAAG,CAAIgB,CAAAA,CAAAA,CAAS,MAAQ,CAAA,CAAA,EAAA,CAAK,CACxC,MAAMC,CAAuBD,CAAAA,CAAAA,CAAS,CAAC,CAAA,CACjCE,CAAmC,CAAA,CAAC,UAAY,CAAA,UAAA,CAAY,MAAM,CACrE,CAAA,GAAA,CAAKC,CAAmBF,EAAAA,CAAAA,CAAI,YAAaE,CAAAA,CAAM,CAAC,CAAA,CAChD,OAAQC,CACHA,EAAAA,CAAAA,CACKL,CAAK,CAAA,QAAA,CAASK,CAAI,CAAA,CAEpB,CACR,CAAA,CAAA,CAEH,GAAIF,CAAW,CAAA,MAAA,EAAUA,CAAY,CAAA,CACnC,MAAMG,CAAAA,CAAyBJ,CAAI,CAAA,YAAA,CAAa,SAAS,CAAA,CACzD,GAAII,CAAAA,CACF,OAAOA,CAAAA,CAAAA,CAKb,OAAO,EACT,CAEA,SAASC,CAAAA,EAAkB,CACzB,IAAIC,CAAeT,CAAAA,CAAAA,CAAuB,MAAQ,CAAA,cAAA,CAAgB,UAAY,CAAA,eAAe,CAE7F,CAAA,OAAKS,CACHA,GAAAA,CAAAA,CAAOvB,CAAI,CAAA,KAAA,CAAA,CAGNuB,CACT,CAEA,SAASC,CAAyB,EAAA,CAQhC,OAP4BV,CAAAA,CAC1B,aACA,CAAA,gBAAA,CACA,qBACA,CAAA,UACF,CAGF,CAEA,MAAMS,CAAAA,CAAeD,CAAQ,EAAA,CACvBG,EAAsBD,CAAe,EAAA,CACrCE,CAAczB,CAAAA,CAAAA,CAAI,MAClBK,CAAAA,CAAAA,CAAkBF,CAAS,EAAA,CASjC,OAP+B,CAC7B,WAAA,CAAAqB,CACA,CAAA,GAAA,CAAAC,CACA,CAAA,KAAA,CAAApB,CACA,CAAA,IAAA,CAAAiB,CACF,CAGF;;;;"}
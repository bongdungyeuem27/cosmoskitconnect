"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var R=require("@cosmoskitconnect/environment"),p=require("@cosmoskitconnect/jsonrpc-types");const g="PARSE_ERROR",O="INVALID_REQUEST",m="METHOD_NOT_FOUND",_="INVALID_PARAMS",c="INTERNAL_ERROR",n="SERVER_ERROR",y=[-32700,-32600,-32601,-32602,-32603],u=[-32e3,-32099],t={[g]:{code:-32700,message:"Parse error"},[O]:{code:-32600,message:"Invalid Request"},[m]:{code:-32601,message:"Method not found"},[_]:{code:-32602,message:"Invalid params"},[c]:{code:-32603,message:"Internal error"},[n]:{code:-32e3,message:"Server error"}},i=n;function b(e){return e<=u[0]&&e>=u[1]}function d(e){return y.includes(e)}function N(e){return typeof e=="number"}function l(e){return Object.keys(t).includes(e)?t[e]:t[i]}function f(e){return Object.values(t).find(o=>o.code===e)||t[i]}function h(e){if(typeof e.error.code>"u")return{valid:!1,error:"Missing code for JSON-RPC error"};if(typeof e.error.message>"u")return{valid:!1,error:"Missing message for JSON-RPC error"};if(!N(e.error.code))return{valid:!1,error:`Invalid error code type for JSON-RPC: ${e.error.code}`};if(d(e.error.code)){const r=f(e.error.code);if(r.message!==t[i].message&&e.error.message===r.message)return{valid:!1,error:`Invalid error code message for JSON-RPC: ${e.error.code}`}}return{valid:!0}}function j(e,r,o){return e.message.includes("getaddrinfo ENOTFOUND")||e.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${o} RPC url at ${r}`):e}const w=R.isNode;var C=Object.defineProperty,T=Object.defineProperties,U=Object.getOwnPropertyDescriptors,v=Object.getOwnPropertySymbols,L=Object.prototype.hasOwnProperty,M=Object.prototype.propertyIsEnumerable,V=(e,r,o)=>r in e?C(e,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[r]=o,W=(e,r)=>{for(var o in r||(r={}))L.call(r,o)&&V(e,o,r[o]);if(v)for(var o of v(r))M.call(r,o)&&V(e,o,r[o]);return e},q=(e,r)=>T(e,U(r));class I{constructor(r){this.i=1;const o=r===8?new Uint8Array(1):r===16?new Uint16Array(1):new Uint32Array(1);this.initialValue=crypto.getRandomValues(o)[0]}getNextValue(){return this.initialValue+this.i++}}const x=new I(8),B=new I(16);function A(){const e=Date.now()*1e3,r=x.getNextValue();return e+r}function F(){const e=BigInt(Date.now())*BigInt(1e6),r=BigInt(B.getNextValue());return e+r}function $(e,r,o){return{id:o||A(),jsonrpc:"2.0",method:e,params:r}}function H(e,r){return{id:e,jsonrpc:"2.0",result:r}}function Q(e,r,o){return{id:e,jsonrpc:"2.0",error:D(r,o)}}function D(e,r){return typeof e>"u"?l(c):(typeof e=="string"&&(e=q(W({},l(n)),{message:e})),typeof r<"u"&&(e.data=r),d(e.code)&&(e=f(e.code)),e)}function G(e){return e.includes("*")?a(e):!/\W/g.test(e)}function s(e){return e==="*"}function a(e){return s(e)?!0:!(!e.includes("*")||e.split("*").length!==2||e.split("*").filter(r=>r.trim()==="").length!==1)}function z(e){return!s(e)&&a(e)&&!e.split("*")[0].trim()}function K(e){return!s(e)&&a(e)&&!e.split("*")[1].trim()}const X="^https?:",Y="^wss?:";function Z(e){const r=e.match(new RegExp(/^\w+:/,"gi"));if(!(!r||!r.length))return r[0]}function S(e,r){const o=Z(e);return typeof o>"u"?!1:new RegExp(r).test(o)}function k(e){return S(e,X)}function ee(e){return S(e,Y)}function re(e){return new RegExp("wss?://localhost(:d{2,5})?").test(e)}function E(e){return typeof e=="object"&&"id"in e&&"jsonrpc"in e&&e.jsonrpc==="2.0"}function oe(e){return E(e)&&"method"in e}function te(e){return E(e)&&(J(e)||P(e))}function J(e){return"result"in e}function P(e){return"error"in e}function ne(e){return"error"in e&&e.valid===!1}exports.DEFAULT_ERROR=i,exports.INTERNAL_ERROR=c,exports.INVALID_PARAMS=_,exports.INVALID_REQUEST=O,exports.METHOD_NOT_FOUND=m,exports.PARSE_ERROR=g,exports.RESERVED_ERROR_CODES=y,exports.SERVER_ERROR=n,exports.SERVER_ERROR_CODE_RANGE=u,exports.STANDARD_ERROR_MAP=t,exports.formatErrorMessage=D,exports.formatJsonRpcError=Q,exports.formatJsonRpcRequest=$,exports.formatJsonRpcResult=H,exports.getBigIntRpcId=F,exports.getError=l,exports.getErrorByCode=f,exports.isHttpUrl=k,exports.isJsonRpcError=P,exports.isJsonRpcPayload=E,exports.isJsonRpcRequest=oe,exports.isJsonRpcResponse=te,exports.isJsonRpcResult=J,exports.isJsonRpcValidationInvalid=ne,exports.isLocalhostUrl=re,exports.isNodeJs=w,exports.isReservedErrorCode=d,exports.isServerErrorCode=b,exports.isValidDefaultRoute=s,exports.isValidErrorCode=N,exports.isValidLeadingWildcardRoute=z,exports.isValidRoute=G,exports.isValidTrailingWildcardRoute=K,exports.isValidWildcardRoute=a,exports.isWsUrl=ee,exports.parseConnectionError=j,exports.payloadId=A,exports.validateJsonRpcError=h,Object.keys(R).forEach(function(e){e!=="default"&&!exports.hasOwnProperty(e)&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return R[e]}})}),Object.keys(p).forEach(function(e){e!=="default"&&!exports.hasOwnProperty(e)&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return p[e]}})});
//# sourceMappingURL=index.cjs.js.map

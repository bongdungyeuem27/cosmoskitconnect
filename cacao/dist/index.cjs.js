"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var h=require("@ethersproject/hash"),v=require("@ethersproject/transactions"),C=require("isomorphic-unfetch");function D(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var $=D(C);const p="https://rpc.walletconnect.com/v1",u=e=>e?.split(":"),m=e=>{const t=e&&u(e);if(t)return t[3]},_=e=>{const t=e&&u(e);if(t)return t[2]+":"+t[3]},w=e=>{const t=e&&u(e);if(t)return t.pop()},A=(e,t)=>{const r=`${e.domain} wants you to sign in with your Ethereum account:`,n=w(t),a=e.statement,o=`URI: ${e.aud}`,s=`Version: ${e.version}`,d=`Chain ID: ${m(t)}`,c=`Nonce: ${e.nonce}`,l=`Issued At: ${e.iat}`,f=e.resources&&e.resources.length>0?`Resources:
${e.resources.map(i=>`- ${i}`).join(`
`)}`:void 0;return[r,n,"",a,"",o,s,d,c,l,f].filter(i=>i!=null).join(`
`)};function I(e,t,r){return v.recoverAddress(h.hashMessage(t),r).toLowerCase()===e.toLowerCase()}async function L(e,t,r,n,a,o){try{const s="0x1626ba7e",d="0000000000000000000000000000000000000000000000000000000000000040",c="0000000000000000000000000000000000000000000000000000000000000041",l=r.substring(2),f=h.hashMessage(t).substring(2),i=s+f+d+c+l,y=await $.default(`${o??p}/?chainId=${n}&projectId=${a}`,{method:"POST",body:JSON.stringify({id:S(),jsonrpc:"2.0",method:"eth_call",params:[{to:e,data:i},"latest"]})}),{result:g}=await y.json();return g?g.slice(0,s.length).toLowerCase()===s.toLowerCase():!1}catch{return!1}}function S(){return Date.now()+Math.floor(Math.random()*1e3)}async function j(e,t,r,n,a){switch(r.t){case"eip191":return I(e,t,r.s);case"eip1271":return await L(e,t,r.s,n,a);default:throw new Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${r.t}`)}}exports.DEFAULT_RPC_URL=p,exports.formatMessage=A,exports.getDidAddress=w,exports.getDidAddressSegments=u,exports.getDidChainId=m,exports.getNamespacedDidChainId=_,exports.verifySignature=j;
//# sourceMappingURL=index.cjs.js.map

(function(B,X){typeof exports=="object"&&typeof module<"u"?X(exports):typeof define=="function"&&define.amd?define(["exports"],X):(B=typeof globalThis<"u"?globalThis:B||self,X(B["@cosmoskitconnect/did-jwt"]={}))})(this,function(B){"use strict";var X={},Tt=Object.freeze({__proto__:null,default:X});/*! noble-ed25519 - MIT License (c) 2019 Paul Miller (paulmillr.com) */const R=BigInt(0),p=BigInt(1),$=BigInt(2),Dt=BigInt(8),dt=BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),U=Object.freeze({a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),P:BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),l:dt,n:dt,h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960")}),ht=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000"),W=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt("6853475219497561581579357271197624642482790079785650197046958215289687604742");const Rt=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),xt=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),Ot=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),Nt=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952");class b{constructor(t,n,r,i){this.x=t,this.y=n,this.z=r,this.t=i}static fromAffine(t){if(!(t instanceof T))throw new TypeError("ExtendedPoint#fromAffine: expected Point");return t.equals(T.ZERO)?b.ZERO:new b(t.x,t.y,p,o(t.x*t.y))}static toAffineBatch(t){const n=$t(t.map(r=>r.z));return t.map((r,i)=>r.toAffine(n[i]))}static normalizeZ(t){return this.toAffineBatch(t).map(this.fromAffine)}equals(t){wt(t);const{x:n,y:r,z:i}=this,{x:s,y:c,z:l}=t,d=o(n*l),g=o(s*i),v=o(r*l),u=o(c*i);return d===g&&v===u}negate(){return new b(o(-this.x),this.y,this.z,o(-this.t))}double(){const{x:t,y:n,z:r}=this,{a:i}=U,s=o(t*t),c=o(n*n),l=o($*o(r*r)),d=o(i*s),g=t+n,v=o(o(g*g)-s-c),u=d+c,E=u-l,a=d-c,f=o(v*E),h=o(u*a),y=o(v*a),w=o(E*u);return new b(f,h,w,y)}add(t){wt(t);const{x:n,y:r,z:i,t:s}=this,{x:c,y:l,z:d,t:g}=t,v=o((r-n)*(l+c)),u=o((r+n)*(l-c)),E=o(u-v);if(E===R)return this.double();const a=o(i*$*g),f=o(s*$*d),h=f+a,y=u+v,w=f-a,A=o(h*E),m=o(y*w),I=o(h*w),_=o(E*y);return new b(A,m,_,I)}subtract(t){return this.add(t.negate())}precomputeWindow(t){const n=1+256/t,r=[];let i=this,s=i;for(let c=0;c<n;c++){s=i,r.push(s);for(let l=1;l<2**(t-1);l++)s=s.add(i),r.push(s);i=s.double()}return r}wNAF(t,n){!n&&this.equals(b.BASE)&&(n=T.BASE);const r=n&&n._WINDOW_SIZE||1;if(256%r)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let i=n&&tt.get(n);i||(i=this.precomputeWindow(r),n&&r!==1&&(i=b.normalizeZ(i),tt.set(n,i)));let s=b.ZERO,c=b.BASE;const l=1+256/r,d=2**(r-1),g=BigInt(2**r-1),v=2**r,u=BigInt(r);for(let E=0;E<l;E++){const a=E*d;let f=Number(t&g);t>>=u,f>d&&(f-=v,t+=p);const h=a,y=a+Math.abs(f)-1,w=E%2!==0,A=f<0;f===0?c=c.add(ut(w,i[h])):s=s.add(ut(A,i[y]))}return b.normalizeZ([s,c])[0]}multiply(t,n){return this.wNAF(k(t,U.l),n)}multiplyUnsafe(t){let n=k(t,U.l,!1);const r=b.BASE,i=b.ZERO;if(n===R)return i;if(this.equals(i)||n===p)return this;if(this.equals(r))return this.wNAF(n);let s=i,c=this;for(;n>R;)n&p&&(s=s.add(c)),c=c.double(),n>>=p;return s}isSmallOrder(){return this.multiplyUnsafe(U.h).equals(b.ZERO)}isTorsionFree(){let t=this.multiplyUnsafe(U.l/$).double();return U.l%$&&(t=t.add(this)),t.equals(b.ZERO)}toAffine(t){const{x:n,y:r,z:i}=this,s=this.equals(b.ZERO);t==null&&(t=s?Dt:V(i));const c=o(n*t),l=o(r*t),d=o(i*t);if(s)return T.ZERO;if(d!==p)throw new Error("invZ was invalid");return new T(c,l)}fromRistrettoBytes(){Q()}toRistrettoBytes(){Q()}fromRistrettoHash(){Q()}}b.BASE=new b(U.Gx,U.Gy,p,o(U.Gx*U.Gy)),b.ZERO=new b(R,p,p,R);function ut(e,t){const n=t.negate();return e?n:t}function wt(e){if(!(e instanceof b))throw new TypeError("ExtendedPoint expected")}function L(e){if(!(e instanceof O))throw new TypeError("RistrettoPoint expected")}function Q(){throw new Error("Legacy method: switch to RistrettoPoint")}class O{constructor(t){this.ep=t}static calcElligatorRistrettoMap(t){const{d:n}=U,r=o(W*t*t),i=o((r+p)*Ot);let s=BigInt(-1);const c=o((s-n*r)*o(r+n));let{isValid:l,value:d}=ot(i,c),g=o(d*t);C(g)||(g=o(-g)),l||(d=g),l||(s=r);const v=o(s*(r-p)*Nt-c),u=d*d,E=o((d+d)*c),a=o(v*Rt),f=o(p-u),h=o(p+u);return new b(o(E*h),o(f*a),o(a*h),o(E*f))}static hashToCurve(t){t=H(t,64);const n=rt(t.slice(0,32)),r=this.calcElligatorRistrettoMap(n),i=rt(t.slice(32,64)),s=this.calcElligatorRistrettoMap(i);return new O(r.add(s))}static fromHex(t){t=H(t,32);const{a:n,d:r}=U,i="RistrettoPoint.fromHex: the hex is not valid encoding of RistrettoPoint",s=rt(t);if(!Zt(q(s),t)||C(s))throw new Error(i);const c=o(s*s),l=o(p+n*c),d=o(p-n*c),g=o(l*l),v=o(d*d),u=o(n*r*g-v),{isValid:E,value:a}=gt(o(u*v)),f=o(a*d),h=o(a*f*u);let y=o((s+s)*f);C(y)&&(y=o(-y));const w=o(l*h),A=o(y*w);if(!E||C(A)||w===R)throw new Error(i);return new O(new b(y,w,p,A))}toRawBytes(){let{x:t,y:n,z:r,t:i}=this.ep;const s=o(o(r+n)*o(r-n)),c=o(t*n),l=o(c*c),{value:d}=gt(o(s*l)),g=o(d*s),v=o(d*c),u=o(g*v*i);let E;if(C(i*u)){let f=o(n*W),h=o(t*W);t=f,n=h,E=o(g*xt)}else E=v;C(t*u)&&(n=o(-n));let a=o((r-n)*E);return C(a)&&(a=o(-a)),q(a)}toHex(){return j(this.toRawBytes())}toString(){return this.toHex()}equals(t){L(t);const n=this.ep,r=t.ep,i=o(n.x*r.y)===o(n.y*r.x),s=o(n.y*r.y)===o(n.x*r.x);return i||s}add(t){return L(t),new O(this.ep.add(t.ep))}subtract(t){return L(t),new O(this.ep.subtract(t.ep))}multiply(t){return new O(this.ep.multiply(t))}multiplyUnsafe(t){return new O(this.ep.multiplyUnsafe(t))}}O.BASE=new O(b.BASE),O.ZERO=new O(b.ZERO);const tt=new WeakMap;class T{constructor(t,n){this.x=t,this.y=n}_setWindowSize(t){this._WINDOW_SIZE=t,tt.delete(this)}static fromHex(t,n=!0){const{d:r,P:i}=U;t=H(t,32);const s=t.slice();s[31]=t[31]&-129;const c=K(s);if(n&&c>=i)throw new Error("Expected 0 < hex < P");if(!n&&c>=ht)throw new Error("Expected 0 < hex < 2**256");const l=o(c*c),d=o(l-p),g=o(r*l+p);let{isValid:v,value:u}=ot(d,g);if(!v)throw new Error("Point.fromHex: invalid y coordinate");const E=(u&p)===p;return(t[31]&128)!==0!==E&&(u=o(-u)),new T(u,c)}static async fromPrivateKey(t){return(await ct(t)).point}toRawBytes(){const t=q(this.y);return t[31]|=this.x&p?128:0,t}toHex(){return j(this.toRawBytes())}toX25519(){const{y:t}=this,n=o((p+t)*V(p-t));return q(n)}isTorsionFree(){return b.fromAffine(this).isTorsionFree()}equals(t){return this.x===t.x&&this.y===t.y}negate(){return new T(o(-this.x),this.y)}add(t){return b.fromAffine(this).add(b.fromAffine(t)).toAffine()}subtract(t){return this.add(t.negate())}multiply(t){return b.fromAffine(this).multiply(t,this).toAffine()}}T.BASE=new T(U.Gx,U.Gy),T.ZERO=new T(R,p);class et{constructor(t,n){this.r=t,this.s=n,this.assertValidity()}static fromHex(t){const n=H(t,64),r=T.fromHex(n.slice(0,32),!1),i=K(n.slice(32,64));return new et(r,i)}assertValidity(){const{r:t,s:n}=this;if(!(t instanceof T))throw new Error("Expected Point instance");return k(n,U.l,!1),this}toRawBytes(){const t=new Uint8Array(64);return t.set(this.r.toRawBytes()),t.set(q(this.s),32),t}toHex(){return j(this.toRawBytes())}}function yt(...e){if(!e.every(r=>r instanceof Uint8Array))throw new Error("Expected Uint8Array list");if(e.length===1)return e[0];const t=e.reduce((r,i)=>r+i.length,0),n=new Uint8Array(t);for(let r=0,i=0;r<e.length;r++){const s=e[r];n.set(s,i),i+=s.length}return n}const zt=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function j(e){if(!(e instanceof Uint8Array))throw new Error("Uint8Array expected");let t="";for(let n=0;n<e.length;n++)t+=zt[e[n]];return t}function nt(e){if(typeof e!="string")throw new TypeError("hexToBytes: expected string, got "+typeof e);if(e.length%2)throw new Error("hexToBytes: received invalid unpadded hex");const t=new Uint8Array(e.length/2);for(let n=0;n<t.length;n++){const r=n*2,i=e.slice(r,r+2),s=Number.parseInt(i,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");t[n]=s}return t}function pt(e){const n=e.toString(16).padStart(64,"0");return nt(n)}function q(e){return pt(e).reverse()}function C(e){return(o(e)&p)===p}function K(e){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");return BigInt("0x"+j(Uint8Array.from(e).reverse()))}const Mt=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function rt(e){return o(K(e)&Mt)}function o(e,t=U.P){const n=e%t;return n>=R?n:t+n}function V(e,t=U.P){if(e===R||t<=R)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let n=o(e,t),r=t,i=R,s=p;for(;n!==R;){const l=r/n,d=r%n,g=i-s*l;r=n,n=d,i=s,s=g}if(r!==p)throw new Error("invert: does not exist");return o(i,t)}function $t(e,t=U.P){const n=new Array(e.length),r=e.reduce((s,c,l)=>c===R?s:(n[l]=s,o(s*c,t)),p),i=V(r,t);return e.reduceRight((s,c,l)=>c===R?s:(n[l]=o(s*n[l],t),o(s*c,t)),i),n}function z(e,t){const{P:n}=U;let r=e;for(;t-- >R;)r*=r,r%=n;return r}function Ct(e){const{P:t}=U,n=BigInt(5),r=BigInt(10),i=BigInt(20),s=BigInt(40),c=BigInt(80),d=e*e%t*e%t,g=z(d,$)*d%t,v=z(g,p)*e%t,u=z(v,n)*v%t,E=z(u,r)*u%t,a=z(E,i)*E%t,f=z(a,s)*a%t,h=z(f,c)*f%t,y=z(h,c)*f%t,w=z(y,r)*u%t;return{pow_p_5_8:z(w,$)*e%t,b2:d}}function ot(e,t){const n=o(t*t*t),r=o(n*n*t),i=Ct(e*r).pow_p_5_8;let s=o(e*n*i);const c=o(t*s*s),l=s,d=o(s*W),g=c===e,v=c===o(-e),u=c===o(-e*W);return g&&(s=l),(v||u)&&(s=d),C(s)&&(s=o(-s)),{isValid:g||v,value:s}}function gt(e){return ot(p,e)}function st(e){return o(K(e),U.l)}function Zt(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function H(e,t){const n=e instanceof Uint8Array?Uint8Array.from(e):nt(e);if(typeof t=="number"&&n.length!==t)throw new Error(`Expected ${t} bytes`);return n}function k(e,t,n=!0){if(!t)throw new TypeError("Specify max value");if(typeof e=="number"&&Number.isSafeInteger(e)&&(e=BigInt(e)),typeof e=="bigint"&&e<t){if(n){if(R<e)return e}else if(R<=e)return e}throw new TypeError("Expected valid scalar: 0 < scalar < max")}function Ht(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}function Xt(e){if(e=typeof e=="bigint"||typeof e=="number"?pt(k(e,ht)):H(e),e.length!==32)throw new Error("Expected 32 bytes");return e}function Wt(e){const t=Ht(e.slice(0,32)),n=e.slice(32,64),r=st(t),i=T.BASE.multiply(r),s=i.toRawBytes();return{head:t,prefix:n,scalar:r,point:i,pointBytes:s}}let it;async function ct(e){return Wt(await N.sha512(Xt(e)))}async function jt(e,t){e=H(e);const{prefix:n,scalar:r,pointBytes:i}=await ct(t),s=st(await N.sha512(n,e)),c=T.BASE.multiply(s),l=st(await N.sha512(c.toRawBytes(),i,e)),d=o(s+l*r,U.l);return new et(c,d).toRawBytes()}T.BASE._setWindowSize(8);const Z={node:Tt,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0},N={bytesToHex:j,hexToBytes:nt,concatBytes:yt,getExtendedPublicKey:ct,mod:o,invert:V,TORSION_SUBGROUP:["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"],hashToPrivateScalar:e=>{if(e=H(e),e.length<40||e.length>1024)throw new Error("Expected 40-1024 bytes of private key as per FIPS 186");return o(K(e),U.l-p)+p},randomBytes:(e=32)=>{if(Z.web)return Z.web.getRandomValues(new Uint8Array(e));if(Z.node){const{randomBytes:t}=Z.node;return new Uint8Array(t(e).buffer)}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>N.randomBytes(32),sha512:async(...e)=>{const t=yt(...e);if(Z.web){const n=await Z.web.subtle.digest("SHA-512",t.buffer);return new Uint8Array(n)}else{if(Z.node)return Uint8Array.from(Z.node.createHash("sha512").update(t).digest());throw new Error("The environment doesn't have sha512 function")}},precompute(e=8,t=T.BASE){const n=t.equals(T.BASE)?t:new T(t.x,t.y);return n._setWindowSize(e),n.multiply($),n},sha512Sync:void 0};Object.defineProperties(N,{sha512Sync:{configurable:!1,get(){return it},set(e){it||(it=e)}}});function qt(e){if(e.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var r=0;r<e.length;r++){var i=e.charAt(r),s=i.charCodeAt(0);if(t[s]!==255)throw new TypeError(i+" is ambiguous");t[s]=r}var c=e.length,l=e.charAt(0),d=Math.log(c)/Math.log(256),g=Math.log(256)/Math.log(c);function v(a){if(a instanceof Uint8Array||(ArrayBuffer.isView(a)?a=new Uint8Array(a.buffer,a.byteOffset,a.byteLength):Array.isArray(a)&&(a=Uint8Array.from(a))),!(a instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(a.length===0)return"";for(var f=0,h=0,y=0,w=a.length;y!==w&&a[y]===0;)y++,f++;for(var A=(w-y)*g+1>>>0,m=new Uint8Array(A);y!==w;){for(var I=a[y],_=0,D=A-1;(I!==0||_<h)&&D!==-1;D--,_++)I+=256*m[D]>>>0,m[D]=I%c>>>0,I=I/c>>>0;if(I!==0)throw new Error("Non-zero carry");h=_,y++}for(var S=A-h;S!==A&&m[S]===0;)S++;for(var x=l.repeat(f);S<A;++S)x+=e.charAt(m[S]);return x}function u(a){if(typeof a!="string")throw new TypeError("Expected String");if(a.length===0)return new Uint8Array;for(var f=0,h=0,y=0;a[f]===l;)h++,f++;for(var w=(a.length-f)*d+1>>>0,A=new Uint8Array(w);a[f];){var m=t[a.charCodeAt(f)];if(m===255)return;for(var I=0,_=w-1;(m!==0||I<y)&&_!==-1;_--,I++)m+=c*A[_]>>>0,A[_]=m%256>>>0,m=m/256>>>0;if(m!==0)throw new Error("Non-zero carry");y=I,f++}for(var D=w-y;D!==w&&A[D]===0;)D++;for(var S=new Uint8Array(h+(w-D)),x=h;D!==w;)S[x++]=A[D++];return S}function E(a){var f=u(a);if(f)return f;throw new Error("Non-base"+c+" character")}return{encode:v,decodeUnsafe:u,decode:E}}var Kt=qt,Et=Kt("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz");function Ft(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var i=0;i<e.length;i++){var s=e.charAt(i),c=s.charCodeAt(0);if(n[c]!==255)throw new TypeError(s+" is ambiguous");n[c]=i}var l=e.length,d=e.charAt(0),g=Math.log(l)/Math.log(256),v=Math.log(256)/Math.log(l);function u(f){if(f instanceof Uint8Array||(ArrayBuffer.isView(f)?f=new Uint8Array(f.buffer,f.byteOffset,f.byteLength):Array.isArray(f)&&(f=Uint8Array.from(f))),!(f instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(f.length===0)return"";for(var h=0,y=0,w=0,A=f.length;w!==A&&f[w]===0;)w++,h++;for(var m=(A-w)*v+1>>>0,I=new Uint8Array(m);w!==A;){for(var _=f[w],D=0,S=m-1;(_!==0||D<y)&&S!==-1;S--,D++)_+=256*I[S]>>>0,I[S]=_%l>>>0,_=_/l>>>0;if(_!==0)throw new Error("Non-zero carry");y=D,w++}for(var x=m-y;x!==m&&I[x]===0;)x++;for(var P=d.repeat(h);x<m;++x)P+=e.charAt(I[x]);return P}function E(f){if(typeof f!="string")throw new TypeError("Expected String");if(f.length===0)return new Uint8Array;var h=0;if(f[h]!==" "){for(var y=0,w=0;f[h]===d;)y++,h++;for(var A=(f.length-h)*g+1>>>0,m=new Uint8Array(A);f[h];){var I=n[f.charCodeAt(h)];if(I===255)return;for(var _=0,D=A-1;(I!==0||_<w)&&D!==-1;D--,_++)I+=l*m[D]>>>0,m[D]=I%256>>>0,I=I/256>>>0;if(I!==0)throw new Error("Non-zero carry");w=_,h++}if(f[h]!==" "){for(var S=A-w;S!==A&&m[S]===0;)S++;for(var x=new Uint8Array(y+(A-S)),P=y;S!==A;)x[P++]=m[S++];return x}}}function a(f){var h=E(f);if(h)return h;throw new Error(`Non-${t} character`)}return{encode:u,decodeUnsafe:E,decode:a}}var Vt=Ft,kt=Vt;const Yt=e=>{if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")};class Gt{constructor(t,n,r){this.name=t,this.prefix=n,this.baseEncode=r}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class Jt{constructor(t,n,r){if(this.name=t,this.prefix=n,n.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=n.codePointAt(0),this.baseDecode=r}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return bt(this,t)}}class Pt{constructor(t){this.decoders=t}or(t){return bt(this,t)}decode(t){const n=t[0],r=this.decoders[n];if(r)return r.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const bt=(e,t)=>new Pt({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class Lt{constructor(t,n,r,i){this.name=t,this.prefix=n,this.baseEncode=r,this.baseDecode=i,this.encoder=new Gt(t,n,r),this.decoder=new Jt(t,n,i)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const Qt=({name:e,prefix:t,encode:n,decode:r})=>new Lt(e,t,n,r),vt=({prefix:e,name:t,alphabet:n})=>{const{encode:r,decode:i}=kt(n,t);return Qt({prefix:e,name:t,encode:r,decode:s=>Yt(i(s))})},Y=vt({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"});vt({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});const At=864e5,ft="key",M=":",G="did",Bt="pkh",J=".",mt="K36",It="Jxg",at=e=>e.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"),lt=(e,t)=>{const n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n},Ut=e=>Object.getPrototypeOf(e)===Object.prototype&&Object.keys(e).length,F=e=>{if(!Ut(e))throw new Error(`Supplied object is not valid ${JSON.stringify(e)}`);return at(Buffer.from(new TextEncoder().encode(JSON.stringify(e))).toString("base64"))},te=e=>`${G}${M}${Bt}${M}${e}`,ee=e=>e+At,_t=(e,t,n)=>{const r=at(Buffer.from(n).toString("base64"));return`${F(e)}${J}${F(t)}${J}${r}`},St=(e,t)=>{const n=F(e),r=F(t);return`${n}${J}${r}`},ne=e=>{const t=Et.decode(mt),n=N.hexToBytes(e),r=Y.encode(lt(t,n));return`${G}${M}${ft}${M}${r}`},re=e=>{var t;const n=(t=e.split(M).pop())!=null?t:"",r=N.bytesToHex(Y.decode(n));if(!r.startsWith("ed01"))throw Error("Invalid Ed25519 key");return N.hexToBytes(r.substring(4))},oe=e=>{const t=Et.decode(It),n=N.hexToBytes(e),r=Y.encode(lt(t,n));return`${G}${M}${ft}${M}${r}`},se=e=>{var t;const n=(t=e.split(M).pop())!=null?t:"",r=N.bytesToHex(Y.decode(n));if(!r.startsWith("ec01"))throw Error("Invalid X25519 key");return N.hexToBytes(r.substring(4))},ie=async(e,t)=>{const[,n]=e,r={alg:"EdDSA",typ:"JWT"},i=new TextEncoder().encode(St(r,t)),s=await jt(i,n);return _t(r,t,s)};B.DAY_IN_MS=At,B.DID_DELIMITER=M,B.DID_METHOD_KEY=ft,B.DID_METHOD_PKH=Bt,B.DID_PREFIX=G,B.JWT_DELIMITER=J,B.MULTICODEC_ED25519_HEADER=mt,B.MULTICODEC_X25519_HEADER=It,B.composeDidPkh=te,B.concatUInt8Arrays=lt,B.decodeEd25519Key=re,B.decodeX25519Key=se,B.encodeData=St,B.encodeEd25519Key=ne,B.encodeJwt=_t,B.encodeX25519Key=oe,B.generateJWT=ie,B.isValidObject=Ut,B.jwtExp=ee,B.makeBase64UrlSafe=at,B.objectToHex=F,Object.defineProperty(B,"__esModule",{value:!0})});
//# sourceMappingURL=index.umd.js.map
